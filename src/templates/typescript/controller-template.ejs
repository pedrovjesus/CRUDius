import { Request, Response } from 'express';
import { <%= entityName %>Provider } from '../../services/<%= entityName %>/<%= entityName %>.service';

const <%= entityName.toLowerCase() %>Provider = new <%= entityName %>Provider();

export class <%= entityName %>Controller {

  public async getAll(req: Request, res: Response): Promise<void> {
    try {
      const { page = 1, limit = 10, filter = '' } = req.query;

      const result = await <%= entityName.toLowerCase() %>Provider.getAll(
        Number(page),
        Number(limit),
        String(filter)
      );

      if (result instanceof Error) {
        res.status(500).json(result.message);
        return;
      }

      res.json(result);
    } catch (error) {
      console.error(error);
      res.status(500).send("Erro ao consultar registros");
    }
  }

  public async getById(req: Request, res: Response): Promise<void> {
    try {
      const id = Number(req.params.id);

      const result = await <%= entityName.toLowerCase() %>Provider.getById(id);

      if (result instanceof Error) {
        res.status(404).json(result.message);
        return;
      }

      res.json(result);
    } catch (error) {
      console.error(error);
      res.status(500).send("Erro ao consultar registro");
    }
  }

  public async create(req: Request, res: Response): Promise<void> {
    try {
      const result = await <%= entityName.toLowerCase() %>Provider.create(req.body);

      if (result instanceof Error) {
        res.status(500).json(result.message);
        return;
      }

      res.status(201).json({ id: result });
    } catch (error) {
      console.error(error);
      res.status(500).send("Erro ao criar registro");
    }
  }

  public async updateById(req: Request, res: Response): Promise<void> {
    try {
      const id = Number(req.params.id);

      const result = await <%= entityName.toLowerCase() %>Provider.updateById(id, req.body);

      if (result instanceof Error) {
        res.status(500).json(result.message);
        return;
      }

      res.status(200).send();
    } catch (error) {
      console.error(error);
      res.status(500).send("Erro ao atualizar registro");
    }
  }

  public async deleteById(req: Request, res: Response): Promise<void> {
    try {
      const id = Number(req.params.id);

      const result = await <%= entityName.toLowerCase() %>Provider.deleteById(id);

      if (result instanceof Error) {
        res.status(500).json(result.message);
        return;
      }

      res.status(204).send();
    } catch (error) {
      console.error(error);
      res.status(500).send("Erro ao excluir registro");
    }
  }
}
